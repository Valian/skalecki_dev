<div class="grain"></div>

<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": <%= Jason.encode!(@post.title) %>,
    "description": <%= Jason.encode!(@post.description) %>,
    "datePublished": "<%= Date.to_iso8601(@post.date) %>",
    "author": {
      "@type": "Person",
      "name": "Jakub Skałecki",
      "url": "https://skalecki.dev"
    },
    "publisher": {
      "@type": "Person",
      "name": "Jakub Skałecki",
      "url": "https://skalecki.dev"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "<%= url(@conn, ~p"/blog/#{@post.slug}") %>"
    }
  }
</script>

<Layouts.site_header active={:thoughts} />

<main class="font-sans pt-32 pb-24 px-6 max-w-3xl mx-auto min-h-screen">
  <article class="animate-fade-in">
    <header class="mb-12 border-b border-base-content/10 pb-12">
      <a
        href={~p"/blog"}
        class="inline-flex items-center gap-2 font-mono text-sm text-secondary hover:text-primary transition-colors mb-8"
      >
        <.icon name="hero-arrow-left" class="size-4" />
        <span>All posts</span>
      </a>

      <h1 class="font-serif text-4xl md:text-5xl text-base-content mb-6 leading-tight">
        {@post.title}
      </h1>

      <div class="flex flex-wrap items-center gap-6 text-sm">
        <time class="font-mono text-primary/80">
          {Calendar.strftime(@post.date, "%B %d, %Y")}
        </time>
        <span class="font-mono text-secondary/50">{@post.reading_time} read</span>
        <div :if={@post.tags && @post.tags != []} class="flex gap-2">
          <%= for tag <- @post.tags do %>
            <span class="font-mono text-xs text-secondary/60 px-2 py-1 bg-base-content/5 rounded">
              #{tag}
            </span>
          <% end %>
        </div>
      </div>
    </header>

    <div class="prose prose-lg max-w-none animate-slide-up" style="animation-delay: 0.2s">
      {Phoenix.HTML.raw(@post.body)}
    </div>
  </article>

  <nav
    :if={@prev_post || @next_post}
    class="mt-16 pt-12 border-t border-base-content/10 grid grid-cols-1 md:grid-cols-2 gap-8"
  >
    <div :if={@prev_post} class="group">
      <span class="font-mono text-xs text-secondary/40 block mb-2">Previous</span>
      <a
        href={~p"/blog/#{@prev_post.slug}"}
        class="font-serif text-xl text-base-content group-hover:text-primary transition-colors flex items-center gap-2"
      >
        <.icon
          name="hero-arrow-left"
          class="size-4 group-hover:-translate-x-1 transition-transform"
        />
        {@prev_post.title}
      </a>
    </div>

    <div :if={@next_post} class="group md:text-right md:col-start-2">
      <span class="font-mono text-xs text-secondary/40 block mb-2">Next</span>
      <a
        href={~p"/blog/#{@next_post.slug}"}
        class="font-serif text-xl text-base-content group-hover:text-primary transition-colors flex items-center gap-2 md:justify-end"
      >
        {@next_post.title}
        <.icon
          name="hero-arrow-right"
          class="size-4 group-hover:translate-x-1 transition-transform"
        />
      </a>
    </div>
  </nav>
</main>

<footer class="bg-base-200 py-12 px-6 border-t border-base-content/5">
  <div class="max-w-4xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4 font-mono text-xs text-secondary/40">
    <p>&copy; {Date.utc_today().year} Jakub Skałecki (Valian). All rights reserved.</p>
    <a href="/" class="hover:text-primary transition-colors">Back to Home</a>
  </div>
</footer>
